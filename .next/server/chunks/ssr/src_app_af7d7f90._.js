module.exports=[46845,a=>{a.v({badge:"page-module___8aEwW__badge",header:"page-module___8aEwW__header",scenariosGrid:"page-module___8aEwW__scenariosGrid",status:"page-module___8aEwW__status",tag:"page-module___8aEwW__tag"})},40777,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(38246),e=a.i(39726),f=a.i(46845);let g={ip:a=>/^(\d{1,3}\.){3}\d{1,3}$/.test(a)&&a.split(".").every(a=>255>=parseInt(a)),hostname:a=>/^[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\.[a-zA-Z]{2,})*$/.test(a),url:a=>/^https?:\/\/.+/.test(a),domain:a=>/^([a-zA-Z0-9-]+\.)+[a-zA-Z]{2,}$/.test(a),subnet:a=>/^(\d{1,3}\.){3}\d{1,3}(\/\d{1,2})?$/.test(a),text:()=>!0};function h(){let[a,d]=(0,c.useState)(null),[f,h]=(0,c.useState)(null),[i,j]=(0,c.useState)(null),[k,l]=(0,c.useState)({}),[m,n]=(0,c.useState)(new Set),[o,p]=(0,c.useState)({}),[q,r]=(0,c.useState)({}),s=e.THREAT_ACTORS.find(b=>b.id===a),t=async a=>{if(a.scriptPath&&(a=>{if(!a.inputParams)return!0;let b={},c=!0;for(let d of a.inputParams){let e=o[a.id]?.[d.name]||"";d.required&&!e?(b[d.name]=!0,c=!1):e&&!g[d.type](e)&&(b[d.name]=!0,c=!1)}return r(c=>({...c,[a.id]:b})),c})(a)){h(a.id);try{let b={};if(a.inputParams)for(let c of a.inputParams)b[c.name]=o[a.id]?.[c.name]||"";let c=await fetch("/api/execute",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({scriptPath:a.scriptPath,params:b})}),d=await c.json();l(b=>({...b,[a.id]:d.output||d.error})),n(b=>new Set(b).add(a.id))}catch(b){l(b=>({...b,[a.id]:"Failed to execute TTP."}))}finally{h(null)}}},u=async a=>{if(a.revertScriptPath){j(a.id);try{let b=await fetch("/api/execute",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({scriptPath:a.revertScriptPath,params:{}})}),c=await b.json();l(b=>({...b,[a.id]:`[REVERT OUTPUT]
${c.output||c.error}`})),n(b=>{let c=new Set(b);return c.delete(a.id),c})}catch(b){l(b=>({...b,[a.id]:"Failed to revert TTP."}))}finally{j(null)}}};return s?(0,b.jsxs)("div",{style:{animation:"fadeIn 0.3s ease"},children:[(0,b.jsx)("button",{onClick:()=>d(null),className:"btn",style:{marginBottom:"1rem",padding:"0.5rem 1rem"},children:"â† BACK TO LIBRARY"}),(0,b.jsxs)("div",{className:"card",style:{border:"1px solid var(--primary)",boxShadow:"0 0 15px rgba(0, 255, 65, 0.1)"},children:[(0,b.jsx)("h1",{className:"mono text-primary",style:{fontSize:"2rem",marginBottom:"0.5rem"},children:s.name}),s.aliases.length>0&&(0,b.jsxs)("p",{className:"mono text-dim",style:{marginBottom:"1rem"},children:["ALIASES: ",s.aliases.join(", ")]}),(0,b.jsx)("p",{style:{lineHeight:"1.6",marginBottom:"2rem",fontSize:"1.1rem"},children:s.description}),(0,b.jsx)("h3",{className:"mono",style:{borderBottom:"1px solid #333",paddingBottom:"0.5rem",marginBottom:"1rem"},children:"ATTRIBUTED TTPs"}),(0,b.jsx)("div",{style:{display:"grid",gap:"1rem"},children:s.ttps.map(a=>(0,b.jsxs)("div",{style:{background:"rgba(255,255,255,0.03)",padding:"1rem",borderLeft:`2px solid ${m.has(a.id)?"#ff6b35":"var(--primary)"}`},children:[(0,b.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[(0,b.jsx)("span",{className:"mono text-primary",style:{fontWeight:"bold"},children:a.id}),(0,b.jsxs)("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[(0,b.jsx)("span",{className:"mono text-dim",style:{fontSize:"0.8rem"},children:a.tactic.toUpperCase()}),m.has(a.id)&&(0,b.jsx)("span",{style:{background:"#ff6b35",color:"#000",padding:"0.1rem 0.4rem",fontSize:"0.7rem",fontWeight:"bold"},children:"EXECUTED"})]})]}),(0,b.jsx)("h4",{style:{marginBottom:"0.5rem"},children:a.technique}),(0,b.jsx)("p",{className:"text-dim",style:{fontSize:"0.9rem",marginBottom:"1rem"},children:a.description}),(0,b.jsx)("div",{className:"code-block",style:{background:"#000",padding:"0.5rem",fontFamily:"monospace",fontSize:"0.8rem",color:"#0f0",marginBottom:"1rem",overflowX:"auto"},children:a.commandSnippet}),a.inputParams&&a.inputParams.length>0&&(0,b.jsx)("div",{style:{marginBottom:"1rem",display:"grid",gap:"0.5rem"},children:a.inputParams.map(c=>(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"mono text-dim",style:{fontSize:"0.8rem",display:"block",marginBottom:"0.25rem"},children:[c.label," ",c.required&&(0,b.jsx)("span",{style:{color:"#ff3333"},children:"*"})]}),(0,b.jsx)("input",{type:"text",placeholder:c.placeholder,value:o[a.id]?.[c.name]||"",onChange:b=>{var d,e,f;return d=a.id,e=c.name,f=b.target.value,void(p(a=>({...a,[d]:{...a[d]||{},[e]:f}})),q[d]?.[e]&&r(a=>({...a,[d]:{...a[d]||{},[e]:!1}})))},style:{width:"100%",padding:"0.5rem",background:"#111",border:`1px solid ${q[a.id]?.[c.name]?"#ff3333":"#333"}`,color:"#fff",fontFamily:"monospace",fontSize:"0.85rem"}}),q[a.id]?.[c.name]&&(0,b.jsxs)("span",{style:{color:"#ff3333",fontSize:"0.75rem"},children:["Invalid ",c.type," format"]})]},c.name))}),(0,b.jsxs)("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:[a.scriptPath&&(0,b.jsx)("button",{onClick:()=>t(a),className:"btn",disabled:f===a.id,style:{fontSize:"0.8rem",padding:"0.3rem 0.8rem"},children:f===a.id?"EXECUTING...":"EXECUTE"}),a.revertScriptPath&&m.has(a.id)&&(0,b.jsx)("button",{onClick:()=>u(a),disabled:i===a.id,style:{fontSize:"0.8rem",padding:"0.3rem 0.8rem",background:"#ff6b35",color:"#000",border:"none",cursor:"pointer",fontWeight:"bold"},children:i===a.id?"REVERTING...":"REVERT"}),!a.scriptPath&&(0,b.jsx)("span",{className:"text-dim mono",style:{fontSize:"0.8rem"},children:"PENDING IMPLEMENTATION"})]}),k[a.id]&&(0,b.jsx)("div",{style:{marginTop:"1rem",background:"#111",padding:"0.5rem",border:"1px solid #333"},children:(0,b.jsx)("pre",{style:{margin:0,whiteSpace:"pre-wrap",fontSize:"0.8rem",color:"#ccc"},children:k[a.id]})})]},a.id))})]})]}):(0,b.jsx)("div",{children:(0,b.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"1.5rem"},children:e.THREAT_ACTORS.map(a=>(0,b.jsxs)("div",{className:"card",style:{cursor:"pointer",transition:"transform 0.2s",border:"1px solid #333"},onClick:()=>d(a.id),onMouseEnter:a=>a.currentTarget.style.borderColor="var(--primary)",onMouseLeave:a=>a.currentTarget.style.borderColor="#333",children:[(0,b.jsx)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"1rem"},children:(0,b.jsx)("span",{className:"mono text-primary",style:{fontSize:"1.2rem"},children:a.name})}),(0,b.jsxs)("p",{className:"text-dim",style:{fontSize:"0.9rem",lineHeight:"1.5"},children:[a.description.substring(0,100),"..."]}),(0,b.jsx)("div",{style:{marginTop:"1rem",display:"flex",gap:"0.5rem"},children:(0,b.jsxs)("span",{className:"tag",children:[a.ttps.length," TTPs"]})})]},a.id))})})}function i(){let[a,g]=(0,c.useState)("threats");return(0,b.jsxs)("main",{className:"container",children:[(0,b.jsxs)("div",{style:{display:"flex",gap:"2rem",marginBottom:"2rem",borderBottom:"1px solid #333",paddingBottom:"1rem"},children:[(0,b.jsx)("button",{onClick:()=>g("threats"),className:"mono",style:{background:"none",border:"none",color:"threats"===a?"var(--primary)":"#666",fontSize:"1.2rem",cursor:"pointer",padding:"0.5rem 0",borderBottom:"threats"===a?"2px solid var(--primary)":"2px solid transparent",transition:"all 0.2s"},children:"THREAT LIBRARY"}),(0,b.jsx)("button",{onClick:()=>g("scenarios"),className:"mono",style:{background:"none",border:"none",color:"scenarios"===a?"var(--primary)":"#666",fontSize:"1.2rem",cursor:"pointer",padding:"0.5rem 0",borderBottom:"scenarios"===a?"2px solid var(--primary)":"2px solid transparent",transition:"all 0.2s"},children:"GUIDED SCENARIOS"})]}),"threats"===a?(0,b.jsx)(h,{}):(0,b.jsx)("section",{style:{animation:"fadeIn 0.3s ease"},children:(0,b.jsx)("div",{className:f.default.scenariosGrid,children:e.SCENARIOS.map(a=>(0,b.jsxs)("div",{className:"card",style:{border:"1px solid #333"},onMouseEnter:a=>a.currentTarget.style.borderColor="var(--primary)",onMouseLeave:a=>a.currentTarget.style.borderColor="#333",children:[(0,b.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[(0,b.jsx)("span",{className:"badge",style:{color:"var(--secondary)",borderColor:"var(--secondary)"},children:a.adversary}),(0,b.jsx)("span",{className:"mono text-dim",style:{fontSize:"0.8rem"},children:a.difficulty})]}),(0,b.jsx)("h2",{className:"mono text-primary",style:{fontSize:"1.2rem",marginBottom:"0.5rem"},children:a.name}),(0,b.jsxs)("p",{className:"text-dim",style:{fontSize:"0.9rem",marginBottom:"1.5rem",lineHeight:"1.5"},children:[a.description.substring(0,120),"..."]}),(0,b.jsxs)("div",{style:{marginBottom:"1.5rem"},children:[(0,b.jsx)("p",{className:"mono text-dim",style:{fontSize:"0.75rem",marginBottom:"0.5rem"},children:"MITRE ATT&CK:"}),(0,b.jsx)("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:a.mitreTechniques.map(a=>(0,b.jsx)("span",{className:"tag",title:a.name,children:a.id},a.id))})]}),(0,b.jsx)(d.default,{href:`/scenario/${a.id}`,className:"btn",style:{display:"block",textAlign:"center",textDecoration:"none"},children:"INITIALIZE"})]},a.id))})})]})}a.s(["default",()=>i],40777)}];

//# sourceMappingURL=src_app_af7d7f90._.js.map